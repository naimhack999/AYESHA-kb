const moment = require("moment-timezone");

module.exports.config = {
  name: "autosend",
  eventType: [],
  version: "1.0.0",
  credits: "Priyansh + Modified by ChatGPT",
  description: "Send different bold messages every hour (Dhaka time)"
};

module.exports.run = async ({ api }) => {
  // à¦˜à¦£à§à¦Ÿà¦¾ à¦…à¦¨à§à¦¯à¦¾à§Ÿà§€ à¦¬à§‹à¦²à§à¦¡ à¦®à§‡à¦¸à§‡à¦œà¦—à§à¦²à§‹
  const messages = {
    0: "ğ—šğ—¼ğ—¼ğ—± ğ—ºğ—¶ğ—±ğ—»ğ—¶ğ—´ğ—µğ˜! ğ—§ğ—¶ğ—ºğ—² ğ˜ğ—¼ ğ—¿ğ—²ğ˜€ğ˜.",
    1: "ğ—šğ—¼ğ—¼ğ—± ğŸ­ğ—”ğ— ! ğ—ğ—²ğ—²ğ—½ ğ—°ğ—®ğ—¹ğ—º ğ—®ğ—»ğ—± ğ—°ğ—µğ—¶ğ—¹ğ—¹.",
    2: "ğ—œğ˜'ğ˜€ ğŸ®ğ—”ğ— ! ğ— ğ—¼ğ—»ğ—¸ğ—²ğ˜† ğ˜ğ—¶ğ—ºğ—²!",
    3: "ğ—Ÿğ—®ğ˜ğ—² ğ—»ğ—¶ğ—´ğ—µğ˜ ğ—³ğ—¹ğ—¼ğ˜„ğ—²ğ—¿ğ˜€ ğ—¯ğ—¹ğ—¼ğ—¼ğ—º ğ—®ğ˜ ğŸ¯ğ—”ğ— .",
    4: "ğ—ªğ—®ğ—¸ğ—² ğ˜‚ğ—½ ğ—®ğ˜ ğŸ°ğ—”ğ—  ğ—®ğ—»ğ—± ğ—´ğ—²ğ˜ ğ—µğ—®ğ—¿ğ—±!",
    5: "ğ—§ğ—¶ğ—ºğ—² ğ˜ğ—¼ ğ—ºğ—®ğ—¸ğ—² ğ˜ğ—µğ—¶ğ—»ğ—´ğ˜€ ğ—µğ—®ğ—½ğ—½ğ—²ğ—»! ğŸ±ğ—”ğ— .",
    6: "ğ—šğ—¼ğ—¼ğ—± ğ—ºğ—¼ğ—¿ğ—»ğ—¶ğ—»ğ—´ ğŸ²ğ—”ğ— ! ğ—™ğ—²ğ—²ğ—¹ ğ˜ğ—µğ—² ğ—½ğ—¼ğ˜„ğ—²ğ—¿.",
    7: "ğ—¥ğ—¶ğ˜€ğ—² ğ—®ğ—»ğ—± ğ—´ğ—¿ğ—¶ğ—»ğ—± ğ—®ğ˜ 7ğ—”ğ— !",
    8: "ğ—•ğ—¿ğ—²ğ—®ğ—¸ğ—³ğ—®ğ˜€ğ˜ ğ˜ğ—¶ğ—ºğ—² ğŸ´ğ—”ğ— ! ğ—˜ğ—®ğ˜ ğ˜„ğ—²ğ—¹ğ—¹.",
    9: "ğ—šğ—¼ ğ—¼ğ˜‚ğ˜ ğ—®ğ—»ğ—± ğ—´ğ—¿ğ—¶ğ—»ğ—± ğ—®ğ˜ 9ğ—”ğ— !",
    10: "ğ—§ğ—¶ğ—ºğ—² ğ˜ğ—¼ ğ—³ğ—¼ğ—°ğ˜‚ğ˜€ ğ—®ğ˜ ğŸ­ğŸ¬ğ—”ğ— .",
    11: "ğ—Ÿğ˜‚ğ—»ğ—°ğ—µ ğ˜ğ—¶ğ—ºğ—² ğ—®ğ˜ ğŸ­ğŸ­ğ—”ğ— ! ğ—§ğ—®ğ—¸ğ—² ğ—® ğ—¯ğ—¿ğ—²ğ—®ğ—¸.",
    12: "ğ—šğ—¼ğ—¼ğ—± ğ—®ğ—³ğ˜ğ—²ğ—¿ğ—»ğ—¼ğ—¼ğ—»! ğ—œğ˜'ğ˜€ ğŸ­ğŸ®ğ—£ğ— .",
    13: "ğ—ğ—²ğ—²ğ—½ ğ—´ğ—¼ğ—¶ğ—»ğ—´ ğ—®ğ˜ ğŸ­ğŸ¯ğ—£ğ— !",
    14: "ğ—–ğ—¼ğ—³ğ—³ğ—²ğ—² ğ—¯ğ—¿ğ—²ğ—®ğ—¸ ğ˜ğ—¶ğ—ºğ—² ğŸ­ğŸ°ğ—£ğ— .",
    15: "ğ—¬ğ—¼ğ˜‚'ğ—¿ğ—² ğ—±ğ—¼ğ—¶ğ—»ğ—´ ğ—´ğ—¿ğ—²ğ—®ğ˜ ğ—®ğ˜ ğŸ­ğŸ±ğ—£ğ— !",
    16: "ğ—§ğ—¶ğ—ºğ—² ğ˜ğ—¼ ğ˜„ğ—¿ğ—®ğ—½ ğ˜‚ğ—½ ğ—®ğ˜ ğŸ­ğŸ²ğ—£ğ— .",
    17: "ğ—šğ—¼ğ—¼ğ—± ğ—²ğ˜ƒğ—²ğ—»ğ—¶ğ—»ğ—´ ğ—®ğ˜ ğŸ­ğŸ³ğ—£ğ— !",
    18: "ğ—ªğ—¶ğ—»ğ—± ğ—±ğ—¼ğ˜„ğ—» ğ—®ğ˜ ğŸ­ğŸ´ğ—£ğ— .",
    19: "ğ—¥ğ—²ğ—¹ğ—®ğ˜… ğ—®ğ—»ğ—± ğ—°ğ—µğ—¶ğ—¹ğ—¹ ğ—®ğ˜ ğŸ­ğŸµğ—£ğ— .",
    20: "ğ—§ğ—¶ğ—ºğ—² ğ—³ğ—¼ğ—¿ ğ—±ğ—¶ğ—»ğ—»ğ—²ğ—¿ ğŸ®ğŸ¬ğ—£ğ— .",
    21: "ğ—šğ—¼ğ—¼ğ—± ğ—»ğ—¶ğ—´ğ—µğ˜ ğ—®ğ˜ ğŸ®ğŸ­ğ—£ğ— !",
    22: "ğ—§ğ—¶ğ—ºğ—² ğ˜ğ—¼ ğ—°ğ—µğ—¶ğ—¹ğ—¹ ğ—®ğ˜ ğŸ®ğŸ®ğ—£ğ— .",
    23: "ğ—Ÿğ—®ğ˜ğ—² ğ—»ğ—¶ğ—´ğ—µğ˜ ğ˜ğ—µğ—¼ğ˜‚ğ—´ğ—µğ˜ğ˜€ ğ—®ğ˜ ğŸ®ğŸ¯ğ—£ğ— ."
  };

  let sentHour = null;

  setInterval(async () => {
    const now = moment.tz('Asia/Dhaka');
    const hour = now.hour();
    const minute = now.minute();
    const second = now.second();

    if (minute === 0 && second === 0 && sentHour !== hour) {
      if ((hour >= 0 && hour <= 11) || (hour >= 12 && hour <= 23)) {
        const allThread = global.data.allThreadID || [];
        const failed = [];

        const messageToSend = messages[hour] || `ğ—›ğ—²ğ—¹ğ—¹ğ—¼! ğ—§ğ—¶ğ—ºğ—²: ${hour}:00`;

        for (const threadID of allThread) {
          if (!isNaN(threadID)) {
            api.sendMessage(messageToSend, threadID, (err) => {
              if (err) failed.push(threadID);
            });
          }
        }

        for (const admin of global.config.ADMINBOT || []) {
          api.sendMessage(`âœ… Hourly message sent at ${hour}:00\nâŒ Failed threads:\n${failed.join("\n")}`, admin);
        }

        sentHour = hour;
      }
    }
  }, 1000);
};
